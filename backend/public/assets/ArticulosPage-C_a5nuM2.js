import{j as a,u as x,t as l}from"./index-CB-Ik059.js";import{I as h,C as j,B as q,a as S}from"./CancelButtonModal-DFIIInB4.js";import{d as v,u as g,g as M,v as A,w as F,x as _,y as w,B as D}from"./BaseTable-lMESkOGa.js";import{M as E}from"./ModalDelete-Bkq3cXQz.js";import{u as I}from"./configAxios-zIrC1_jU.js";import{u as y,S as n}from"./sweetalert2.esm.all-nsIXK1sI.js";import"./square-pen-D170uhu7.js";const P={generalFields:[{required:!0,type:"text",label:"Nombre del artículo *",name:"nombre"},{required:!0,type:"number",step:"0.01",label:"Precio de compra *",name:"precio_compra"},{required:!0,type:"number",step:"0.01",label:"Precio de venta *",name:"precio_venta"},{required:!0,type:"number",step:"0.01",label:"Precio de reposición *",name:"precio_reposicion"},{required:!0,type:"select",label:"¿Artículo para asignación de equipo? *",name:"articulo_equipar",opcSelect:[{label:"Selecciona una opción",value:""},{label:"SI",value:"SI"},{label:"NO",value:"NO"}]}]},B=()=>{const{view:r,formData:i,handleInputChange:o}=v();return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:P.generalFields.map(({type:s,label:c,name:t,required:u,opcSelect:d,step:m})=>a.jsx(h,{type:s,label:c,name:t,step:m,required:u,value:i[t]||"",opcSelect:d,onChange:o,disabled:r,classInput:"md:col-span-1"},t))}),a.jsx("hr",{className:"text-gray-300"}),r?a.jsx(j,{}):a.jsx(q,{})]})},C=()=>{const r=g(e=>e.modalType),i=g(e=>e.formData),o=g(e=>e.closeModal),s=x(),{isError:c,data:t,error:u,isLoading:d}=I({queryKey:["articulos"],queryFn:w}),m=y({mutationFn:_,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro agregado"),o(),n.close()},onError:e=>{l.error(e.message),n.close()}}),b=y({mutationFn:F,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro actualizado"),o(),n.close()},onError:e=>{l.error(e.message),n.close()}}),f=y({mutationFn:A,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro eliminado")},onError:e=>{l.error(e.message)}});return{isLoading:d,isError:c,data:t,error:u,createMutation:m,updateMutation:b,deleteMutation:f,handleSubmit:e=>{e.preventDefault(),n.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{n.showLoading()}}),r==="add"?m.mutate(i):r==="edit"&&b.mutate(i)},handleDelete:e=>{f.mutate(e),o()},loadOptions:async()=>{try{return(await M()).map(p=>({value:p.id,label:`${p.nombre} ${p.apellido_p} ${p.apellido_m}`}))}catch(e){return console.error("Error cargando empleados:",e),[]}}}},O=[{key:"nombre",name:"Artículo"},{key:"precio_compra",name:"Precio de compra"},{key:"precio_venta",name:"Precio de venta"},{key:"precio_reposicion",name:"Precio de reposición"},{key:"articulo_equipar",name:"Artículo para asignar"}];function H(){const{modalType:r,currentItem:i}=v(),{data:o,isLoading:s,isError:c,error:t,handleSubmit:u,handleDelete:d}=C();return c?a.jsx("div",{children:t.message}):a.jsxs("div",{className:"md:p-4 bg-gray-100",children:[a.jsx(D,{columns:O,data:o||[],title:"Articulos",loading:s}),(r==="add"||r==="edit"||r==="view")&&a.jsx(S,{handleSubmit:u,Inputs:a.jsx(B,{})}),r==="delete"&&i&&a.jsx(E,{handleDelete:d})]})}export{H as default};
