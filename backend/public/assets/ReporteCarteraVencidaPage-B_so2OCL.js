import{j as a,a as g}from"./index-CrpPZsvu.js";import{C as b,B as y,a as v}from"./CancelButtonModal-BoD_aq40.js";import{u as _,B as x}from"./BaseTable-CsPZTHSS.js";import{I as C}from"./InputField-CAlv3cmG.js";import{u as j}from"./useQuery-JHOG_8HK.js";import{n as i}from"./useReportes-fRvlvEg1.js";import"./eye-DTpaqRd9.js";const q={generalFields:[{required:!0,type:"async",label:"Sucursal *",name:"cotizacion_id"},{required:!0,type:"select",label:"Tipo de pago *",name:"tipo_pago",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"Crédito",label:"Crédito"},{value:"Contado",label:"Contado"}]},{required:!0,type:"select",label:"Método de pago *",name:"metodo_pago",opcSelect:[{label:"Selecciona una opción",value:""},{label:"Transferencia bancaria",value:"Transferencia bancaria"},{label:"Tarjeta de crédito/débito",value:"Tarjeta de crédito/débito"},{label:"Efectivo",value:"Efectivo"},{label:"Cheques",value:"Cheques"}]},{required:!0,type:"text",label:"Número de factura",name:"numero_factura"},{required:!0,type:"date",label:"Fecha de cotización aceptada",name:"fecha_emision"},{required:!1,type:"date",label:"Fecha límite de pago",name:"fecha_vencimiento"},{required:!0,type:"number",step:"0.01",label:"Monto de la nota de credito *",name:"nota_credito"}]},F=()=>{const{view:t,formData:o,handleInputChange:n,loadOptionsCotizaciones:e}=_();return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:q.generalFields.map(({type:r,label:u,name:c,required:s,opcSelect:d,step:m})=>a.jsx(C,{type:r,label:u,name:c,required:s,value:o[c]||"",opcSelect:d,step:m,loadOptions:e,onChange:n,disabled:!0,classInput:"md:col-span-1"},c))}),a.jsx("hr",{className:"text-gray-300"}),t?a.jsx(b,{}):a.jsx(y,{})]})},z=async()=>{try{const t=await g.get("cartera-vencida"),{data:o}=t;return Array.isArray(o)?o.map(e=>{var s,d,m,l,p,f;const r=(s=e==null?void 0:e.cotizacion)!=null&&s.sucursal?(m=(d=e==null?void 0:e.cotizacion)==null?void 0:d.sucursal)==null?void 0:m.nombre_empresa:(l=e==null?void 0:e.cotizacion)==null?void 0:l.nombre_empresa,u=((f=(p=e==null?void 0:e.cotizacion)==null?void 0:p.sucursal)==null?void 0:f.cliente.nombre_empresa)||"N/A",c=typeof r=="string"?r:"N/A";return{...e,cotizacion_id:{label:r,value:e.cotizacion.id},cliente:u,sucursal:c,numero_factura:e.numero_factura,fecha_emision:e.fecha_emision,fecha_vencimiento:e.fecha_vencimiento,total:e.total,nota_credito:e.nota_credito,tipo_pago:e.tipo_pago,metodo_pago:e.metodo_pago,estatus:e.estatus,credito_dias:e.cotizacion.credito_dias,fecha_vencimiento_format:i(e.fecha_vencimiento).format("DD/MM/YYYY"),atraso:i().diff(i(e.fecha_vencimiento),"day"),total_format:`$${e.total}`}}):[]}catch(t){throw console.error("Error al obetener el registro",t),new Error(t.response.data.message)}},E=()=>{const{isLoading:t,isError:o,data:n,error:e}=j({queryKey:["reporte-cartera-vencida"],queryFn:z});return{data:n,error:e,isError:o,isLoading:t}},T=[{key:"cliente",name:"Cliente"},{key:"sucursal",name:"Sucursal"},{key:"numero_factura",name:"Número Factura"},{key:"fecha_vencimiento_format",name:"Fecha vencimiento"},{key:"total_format",name:"Total"},{key:"atraso",name:"Días de atraso"},{key:"estatus",name:"Estatus"}];function S(){const{modalType:t}=_(),{data:o,isLoading:n,isError:e,error:r}=E();return e?a.jsx("div",{children:r.message}):a.jsxs("div",{className:"md:p-4 bg-gray-100",children:[a.jsx(x,{columns:T,data:o||[],title:"Reporte de cartera vencida (de 1 a 3 meses)",loading:n}),t==="view"&&a.jsx(v,{Inputs:a.jsx(F,{})})]})}export{S as default};
