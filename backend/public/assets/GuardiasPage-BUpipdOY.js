import{c as I,r as h,u as G,t as y,j as e}from"./index-CB-Ik059.js";import{I as p,C as A,B,a as R}from"./CancelButtonModal-DFIIInB4.js";import{u as C,e as T,a as K,r as O,b as Q,c as L,g as U,d as E,B as J}from"./BaseTable-lMESkOGa.js";import{M as $}from"./ModalDelete-Bkq3cXQz.js";import{u as z}from"./configAxios-zIrC1_jU.js";import{u as F,S as v}from"./sweetalert2.esm.all-nsIXK1sI.js";import{A as f}from"./AlertaCard-azZSUJ8e.js";import"./square-pen-D170uhu7.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],V=I("Upload",H),M=()=>{const[m,b]=h.useState([]),[o,x]=h.useState([]),[r,t]=h.useState({}),i=C(s=>s.modalType),n=C(s=>s.formData),g=C(s=>s.closeModal),j=G(),{isLoading:l,isError:d,data:a,error:c}=z({queryKey:["guardias"],queryFn:U}),u=F({mutationFn:L,onSuccess:()=>{j.invalidateQueries({queryKey:["guardias"]}),y.success("Registro agregado"),g(),v.close()},onError:s=>{y.error(s.message),v.close()}}),D=F({mutationFn:Q,onSuccess:()=>{j.invalidateQueries({queryKey:["guardias"]}),y.success("Registro actualizado"),g(),v.close()},onError:s=>{y.error(s.message),v.close()}}),N=F({mutationFn:O,onSuccess:()=>{j.invalidateQueries({queryKey:["guardias"]}),y.success("Registro eliminado")},onError:s=>{y.error(s.message)}}),P=s=>{s.preventDefault(),v.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{v.showLoading()}}),i==="add"?u.mutate(n):i==="edit"&&D.mutate(n)},k=s=>{N.mutate(s),g()};h.useEffect(()=>{b(T),t(K)},[]),h.useEffect(()=>{const s=n.estado;if(!s){x([]);return}const S=r[s];x(S?S.map(_=>({value:_,label:_})):[])},[n.estado,r]);const w=[{value:"",label:"Selecciona un estado"},...m.map(s=>({value:s.nombre,label:s.nombre}))];return{isLoading:l,isError:d,data:a,error:c,createMutation:u,updateMutation:D,deleteMutation:N,handleSubmit:P,handleDelete:k,opcionesEstados:w,municipios:o}},q={personalFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre"},{required:!0,type:"text",label:"Apellido paterno *",name:"apellido_p"},{required:!0,type:"text",label:"Apellido materno *",name:"apellido_m"},{required:!0,type:"number",label:"Edad *",name:"edad"},{required:!0,type:"number",label:"Teléfono *",name:"telefono"},{required:!0,type:"email",label:"Correo *",name:"correo"},{required:!0,type:"text",label:"Enfermedades *",name:"enfermedades"},{required:!0,type:"text",label:"Alergias *",name:"alergias"}],direccionFields:[{required:!0,type:"text",label:"Calle *",name:"calle"},{required:!0,type:"text",label:"Número *",name:"numero"},{required:!0,type:"text",label:"Colonia *",name:"colonia"},{required:!0,type:"number",label:"Código postal *",name:"cp"}],otrosFields:[{required:!0,type:"number",label:"Teléfono de emergencia *",name:"telefono_emergencia"},{required:!0,type:"text",label:"Contacto de emergencia *",name:"contacto_emergencia"}],documentFields:[{required:!0,type:"file",label:"CURP (PDF) *",name:"curp",accept:"application/pdf"},{required:!0,type:"file",label:"INE (PDF) *",name:"ine",accept:"application/pdf"},{required:!0,type:"file",label:"Acta de nacimiento (PDF) *",name:"acta_nacimiento",accept:"application/pdf"},{required:!0,type:"file",label:"Comprobante de domicilio (PDF) *",name:"comprobante_domicilio",accept:"application/pdf"},{required:!0,type:"file",label:"Constancia de situación fiscal (PDF) *",name:"constancia_situacion_fiscal",accept:"application/pdf"},{required:!1,type:"file",label:"Comprobante de estudios (PDF)",name:"comprobante_estudios",accept:"application/pdf"},{required:!1,type:"file",label:"Carta de recomendación (PDF)",name:"carta_recomendacion",accept:"application/pdf"},{required:!1,type:"file",label:"Carta de antecedentes no penales (PDF)",name:"antecedentes_no_penales",accept:"application/pdf"},{required:!1,type:"file",label:"Otro archivo (PDF)",name:"otro_archivo",accept:"application/pdf"}],antodopingFields:[{required:!1,type:"file",label:"Antidoping (PDF)",name:"antidoping",accept:"application/pdf"},{required:!1,type:"date",label:"Fecha del último antidoping",name:"fecha_antidoping"}]},W=()=>{const{opcionesEstados:m,municipios:b}=M(),{view:o,edit:x,document:r,formData:t,handleInputChange:i,handleFileChange:n}=E(),g=h.useRef(null),j=()=>{var l;(l=g.current)==null||l.click()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Foto de perfil"})}),e.jsx("div",{className:"sm:col-span-6 md:col-span-2 w-96 mx-auto",children:e.jsxs("div",{onClick:j,className:"cursor-pointer border-2 border-dashed border-gray-300 rounded-lg p-4 transition-all hover:border-blue-500 flex flex-col items-center justify-center",children:[e.jsx("input",{type:"file",ref:g,onChange:n,accept:"image/*",className:"hidden",name:"foto",required:!r,disabled:o}),t.preview||r?e.jsx("div",{className:"w-full",children:e.jsx("img",{src:t.preview||t.foto_url,alt:"Foto de perfil",className:"max-h-60 mx-auto rounded-md object-contain"})}):e.jsxs("div",{className:"py-6 flex flex-col items-center",children:[e.jsx(V,{className:"h-20 w-10 text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500 text-center",children:"Click para seleccionar foto"})]})]})}),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Información personal"})}),q.personalFields.map(({type:l,label:d,name:a,required:c})=>e.jsx(p,{type:l,label:d,name:a,required:c,value:t[a]||"",onChange:i,disabled:o},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Dirección"})}),q.direccionFields.map(({type:l,label:d,name:a,accept:c,required:u})=>e.jsx(p,{type:l,accept:c,label:d,required:u,name:a,value:t[a]||"",onChange:i,disabled:o},a)),e.jsx(p,{label:"Estado *",name:"estado",type:"select",value:t.estado,onChange:l=>{i(l),i({target:{name:"municipio",value:""}})},required:!0,disabled:o,opcSelect:m}),e.jsx(p,{label:"Municipio *",name:"municipio",type:"select",value:t.municipio,onChange:i,required:!0,disabled:o||b.length===0,opcSelect:[{value:"",label:"Selecciona un municipio"},...b]}),e.jsx(p,{label:"País *",name:"pais",type:"text",onChange:i,required:!0,disabled:!0,value:"México"}),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Documentos"})}),q.documentFields.map(({type:l,label:d,name:a,accept:c,required:u})=>e.jsx(p,{type:l,accept:c,label:d,required:r?!r:u,name:a,value:t[a]||"",onChange:n,document:t[`${a}_url`]||null,disabled:o},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Antidoping"})}),q.antodopingFields.map(({type:l,label:d,name:a,accept:c,required:u})=>e.jsx(p,{type:l,accept:c,label:d,required:r?!r:u,name:a,value:t[a]||"",onChange:l==="file"?n:i,document:t[`${a}_url`]||null,disabled:o},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Otros datos"})}),q.otrosFields.map(({type:l,label:d,name:a,accept:c,required:u})=>e.jsx(p,{type:l,accept:c,label:d,required:u,name:a,value:t[a]||"",onChange:l==="file"?n:i,disabled:o},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Información de rango"})}),e.jsx(p,{type:"select",label:"Nivel del guardia *",required:!0,name:"rango",value:t.rango||"",opcSelect:[{label:"Selecciona una opción",value:""},{label:"Guardia",value:"Guardia"},{label:"Supervisor",value:"Supervisor"},{label:"Jefe de grupo",value:"Jefe de grupo"}],onChange:i,disabled:o,classInput:"md:col-span-2"}),x&&e.jsx(p,{type:"select",label:"Nivel del guardia *",required:!0,name:"estatus",value:t.estatus||"",opcSelect:[{label:"Selecciona una opción",value:""},{label:"Disponible",value:"Disponible"},{label:"Descansado",value:"Descansado"},{label:"Dado de baja",value:"Dado de baja"},{label:"Asignado",value:"Asignado"}],onChange:i,disabled:o,classInput:"md:col-span-2"})]}),e.jsx("hr",{className:"text-gray-300"}),o?e.jsx(A,{}):e.jsx(B,{})]})},X=[{key:"nombre_completo",name:"Nombre"},{key:"direccion_completa",name:"Dirección"},{key:"telefono",name:"Teléfono"},{key:"rango",name:"Rango"},{key:"estatus",name:"Estatus"}];function ie(){const{modalType:m,currentItem:b}=E(),{data:o,isLoading:x,isError:r,error:t,handleSubmit:i,handleDelete:n}=M();return r?e.jsx("div",{children:t.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(J,{columns:X,data:o||[],title:"Guardias",loading:x}),(m==="add"||m==="edit"||m==="view")&&e.jsx(R,{handleSubmit:i,Inputs:e.jsx(W,{})}),m==="delete"&&b&&e.jsx($,{handleDelete:n})]})}export{ie as default};
