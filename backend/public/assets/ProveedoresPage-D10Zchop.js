import{j as e,u as h,t as m}from"./index-CrpPZsvu.js";import{C as j,B as C,a as F}from"./CancelButtonModal-BoD_aq40.js";import{u as q,a as f,B as _}from"./BaseTable-CsPZTHSS.js";import{M as D}from"./ModalDelete-CfgHdyab.js";import{A as x}from"./AlertaCard-CTxQbRQP.js";import{I as y}from"./InputField-CAlv3cmG.js";import{u as M}from"./useQuery-JHOG_8HK.js";import{u as b,S as c}from"./sweetalert2.esm.all-C9US9OKy.js";import{j as S,k as N,l as P,m as E}from"./useReportes-fRvlvEg1.js";import"./eye-DTpaqRd9.js";import"./circle-alert-DY7SbZfB.js";const g={personalFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre_contacto"},{required:!0,type:"text",label:"Teléfono *",name:"telefono_contacto"},{required:!0,type:"text",label:"WhatsApp *",name:"whatsapp_contacto"},{required:!0,type:"email",label:"Correo *",name:"correo"}],empresaFields:[{required:!0,type:"text",label:"Nombre de la empresa *",name:"nombre_empresa"},{required:!0,type:"text",label:"Calle *",name:"calle"},{required:!0,type:"text",label:"Número *",name:"numero"},{required:!0,type:"text",label:"Colonia *",name:"colonia"},{required:!0,type:"select",label:"Estado *",name:"estado"},{required:!0,type:"select",label:"Municipio *",name:"municipio"},{required:!0,type:"number",label:"Código postal *",name:"cp"},{required:!0,type:"text",label:"País *",name:"pais"},{required:!0,type:"text",label:"Teléfono empresa *",name:"telefono_empresa"},{required:!1,type:"text",label:"Extensión",name:"extension_empresa"},{required:!1,type:"url",label:"Sitio web",name:"pagina_web"},{required:!0,type:"number",label:"Días de crédito *",name:"credito_dias"}],rfcFields:[{required:!0,type:"text",label:"RFC *",name:"rfc"},{required:!0,type:"text",label:"Razón social *",name:"razon_social"},{required:!0,type:"text",label:"Uso de CFDI *",name:"uso_cfdi"},{required:!0,type:"text",label:"Regimen fiscal *",name:"regimen_fiscal"}]},w=()=>{const{view:t,formData:n,handleInputChange:s,opcionesEstados:d,municipios:u}=q();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(x,{text:"Datos del contacto"})}),g.personalFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(y,{type:o,label:l,name:a,required:i,value:n[a]||"",onChange:s,disabled:t,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(x,{text:"Datos de la empresa"})}),g.empresaFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(y,{type:o,label:l,name:a,required:i,value:n[a]||"",onChange:p=>{s(p),a==="estado"&&s({target:{name:"municipio",value:""}})},disabled:a==="municipio"&&u.length===0?!0:t,opcSelect:a==="estado"?d:[{value:"",label:"Selecciona un municipio"},...u],classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(x,{text:"Datos fiscales"})}),g.rfcFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(y,{type:o,label:l,name:a,required:o==="file"?!1:i,value:n[a]||"",onChange:s,document:o==="file"?document:!1,disabled:t,classInput:"md:col-span-1"},a))]}),e.jsx("hr",{className:"text-gray-300"}),t?e.jsx(j,{}):e.jsx(C,{})]})},I=()=>{const t=f(r=>r.modalType),n=f(r=>r.formData),s=f(r=>r.closeModal),d=h(),{isError:u,data:o,error:l,isLoading:a}=M({queryKey:["proveedores"],queryFn:E}),i=b({mutationFn:P,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),m.success("Registro agregado"),s(),c.close()},onError:r=>{m.error(r.message),c.close()}}),p=b({mutationFn:N,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),m.success("Registro actualizado"),s(),c.close()},onError:r=>{m.error(r.message),c.close()}}),v=b({mutationFn:S,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),m.success("Registro eliminado")},onError:r=>{m.error(r.message)}});return{isLoading:a,isError:u,data:o,error:l,createMutation:i,updateMutation:p,deleteMutation:v,handleSubmit:r=>{r.preventDefault(),c.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{c.showLoading()}}),t==="add"?i.mutate(n):t==="edit"&&p.mutate(n)},handleDelete:r=>{v.mutate(r),s()}}},R=[{key:"nombre_empresa",name:"Nombre de la empresa"},{key:"rfc",name:"RFC"},{key:"razon_social",name:"Razón social"},{key:"nombre_contacto",name:"Nombre contacto"},{key:"telefono_contacto",name:"Teléfono contacto"}];function J(){const{modalType:t,currentItem:n}=q(),{data:s,isLoading:d,isError:u,error:o,handleSubmit:l,handleDelete:a}=I();return u?e.jsx("div",{children:o.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(_,{columns:R,data:s||[],title:"Proveedores",loading:d}),(t==="add"||t==="edit"||t==="view")&&e.jsx(F,{handleSubmit:l,Inputs:e.jsx(w,{})}),t==="delete"&&n&&e.jsx(D,{handleDelete:a})]})}export{J as default};
