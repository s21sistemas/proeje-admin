import{c as $,u as K,t as E,k as V,R as Q,r as G,j as d}from"./index-CB-Ik059.js";import{_ as X,b as Y,c as J,d as Z,e as ee,f as te,I as T,C as re,B as ae,a as ne}from"./CancelButtonModal-DFIIInB4.js";import{u as F,g as ie,O as oe,P as se,Q as le,R as ue,S as ce,d as de,B as he}from"./BaseTable-lMESkOGa.js";import{M as pe}from"./ModalDelete-Bkq3cXQz.js";import{u as A}from"./configAxios-zIrC1_jU.js";import{u as R,S as q}from"./sweetalert2.esm.all-nsIXK1sI.js";import{a as ve}from"./vehiculos-BJbokqmd.js";import{A as k}from"./AlertaCard-azZSUJ8e.js";import{S as me}from"./save-D6fDM876.js";import"./square-pen-D170uhu7.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],ge=$("FilePen",fe);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],xe=$("SquareX",ye),H=()=>{const t=F(m=>m.modalType),a=F(m=>m.formData),r=F(m=>m.closeModal),e=F(m=>m.firma),n=F(m=>m.editFirma),i=K(),{isLoading:s,isError:o,data:u,error:l}=A({queryKey:["equipamiento"],queryFn:ue}),{isLoading:h,isError:p,data:c}=A({queryKey:["articulos-asignar"],queryFn:ce}),v=R({mutationFn:se,onSuccess:()=>{i.invalidateQueries({queryKey:["equipamiento"]}),E.success("Registro agregado"),q.close(),r()},onError:m=>{q.close(),E.error(m.message)}}),g=R({mutationFn:le,onSuccess:()=>{i.invalidateQueries({queryKey:["equipamiento"]}),E.success("Registro actualizado"),r(),q.close()},onError:m=>{E.error(m.message),q.close()}}),y=R({mutationFn:oe,onSuccess:()=>{i.invalidateQueries({queryKey:["equipamiento"]}),E.success("Registro eliminado")},onError:m=>{E.error(m.message)}});return{data:u,error:l,isError:o,isLoading:s,loadArti:h,errorArti:p,articulos:c,handleSubmit:m=>{m.preventDefault();let b=null;if(e===null&&t==="add"){E.warning("La firma es obligatoría.");return}else e===null&&t==="edit"?b=a.firma_guardia:e!==null&&(b=e);q.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{q.showLoading()}});const W={...a,guardia_id:a.guardia_id.value,vehiculo_id:a.vehiculo_id.value,firma_guardia:b};t==="add"?v.mutate(W):t==="edit"&&g.mutate(W),n(null)},handleDelete:m=>{y.mutate(m),r()},loadOptionsGuardia:async()=>{try{return(await ie()).map(b=>({value:b.id,label:b.nombre_completo}))}catch(m){return console.error("Error cargando empleados:",m),[]}},loadOptionsVehiculo:async()=>{try{return(await ve()).map(b=>({value:b.id,label:`${b.tipo_vehiculo} - ${b.marca} (${b.placas})`}))}catch(m){return console.error("Error cargando empleados:",m),[]}}}},_e={generalFields:[{required:!0,type:"async",label:"Selecciona al guardia *",name:"guardia_id"},{required:!0,type:"date",label:"Fecha de entrega al guardia *",name:"fecha_entrega"}]};var N={exports:{}},O,z;function be(){if(z)return O;z=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return O=t,O}var D,B;function we(){if(B)return D;B=1;var t=be();function a(){}function r(){}return r.resetWarningCache=a,D=function(){function e(s,o,u,l,h,p){if(p!==t){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function n(){return e}var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:a};return i.PropTypes=i,i},D}var I;function Pe(){return I||(I=1,N.exports=we()()),N.exports}var Se=Pe();const w=V(Se);/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function C(t,a,r){this.x=t,this.y=a,this.time=r||new Date().getTime()}C.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1};C.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))};C.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time};function L(t,a,r,e){this.startPoint=t,this.control1=a,this.control2=r,this.endPoint=e}L.prototype.length=function(){for(var t=10,a=0,r=void 0,e=void 0,n=0;n<=t;n+=1){var i=n/t,s=this._point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),o=this._point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){var u=s-r,l=o-e;a+=Math.sqrt(u*u+l*l)}r=s,e=o}return a};L.prototype._point=function(t,a,r,e,n){return a*(1-t)*(1-t)*(1-t)+3*r*(1-t)*(1-t)*t+3*e*(1-t)*t*t+n*t*t*t};function Ee(t,a,r){var e,n,i,s=null,o=0;r||(r={});var u=function(){o=r.leading===!1?0:Date.now(),s=null,i=t.apply(e,n),s||(e=n=null)};return function(){var l=Date.now();!o&&r.leading===!1&&(o=l);var h=a-(l-o);return e=this,n=arguments,h<=0||h>a?(s&&(clearTimeout(s),s=null),o=l,i=t.apply(e,n),s||(e=n=null)):!s&&r.trailing!==!1&&(s=setTimeout(u,h)),i}}function f(t,a){var r=this,e=a||{};this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=Ee(f.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=f.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(n){n.which===1&&(r._mouseButtonDown=!0,r._strokeBegin(n))},this._handleMouseMove=function(n){r._mouseButtonDown&&r._strokeMoveUpdate(n)},this._handleMouseUp=function(n){n.which===1&&r._mouseButtonDown&&(r._mouseButtonDown=!1,r._strokeEnd(n))},this._handleTouchStart=function(n){if(n.targetTouches.length===1){var i=n.changedTouches[0];r._strokeBegin(i)}},this._handleTouchMove=function(n){n.preventDefault();var i=n.targetTouches[0];r._strokeMoveUpdate(i)},this._handleTouchEnd=function(n){var i=n.target===r._canvas;i&&(n.preventDefault(),r._strokeEnd(n))},this.on()}f.prototype.clear=function(){var t=this._ctx,a=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,a.width,a.height),t.fillRect(0,0,a.width,a.height),this._data=[],this._reset(),this._isEmpty=!0};f.prototype.fromDataURL=function(t){var a=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=new Image,n=r.ratio||window.devicePixelRatio||1,i=r.width||this._canvas.width/n,s=r.height||this._canvas.height/n;this._reset(),e.src=t,e.onload=function(){a._ctx.drawImage(e,0,0,i,s)},this._isEmpty=!1};f.prototype.toDataURL=function(t){var a;switch(t){case"image/svg+xml":return this._toSVG();default:for(var r=arguments.length,e=Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return(a=this._canvas).toDataURL.apply(a,[t].concat(e))}};f.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};f.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};f.prototype.isEmpty=function(){return this._isEmpty};f.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),typeof this.onBegin=="function"&&this.onBegin(t)};f.prototype._strokeUpdate=function(t){var a=t.clientX,r=t.clientY,e=this._createPoint(a,r),n=this._data[this._data.length-1],i=n&&n[n.length-1],s=i&&e.distanceTo(i)<this.minDistance;if(!(i&&s)){var o=this._addPoint(e),u=o.curve,l=o.widths;u&&l&&this._drawCurve(u,l.start,l.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor})}};f.prototype._strokeEnd=function(t){var a=this.points.length>2,r=this.points[0];if(!a&&r&&this._drawDot(r),r){var e=this._data[this._data.length-1],n=e[e.length-1];r.equals(n)||e.push({x:r.x,y:r.y,time:r.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(t)};f.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};f.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};f.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};f.prototype._createPoint=function(t,a,r){var e=this._canvas.getBoundingClientRect();return new C(t-e.left,a-e.top,r||new Date().getTime())};f.prototype._addPoint=function(t){var a=this.points,r=void 0;if(a.push(t),a.length>2){a.length===3&&a.unshift(a[0]),r=this._calculateCurveControlPoints(a[0],a[1],a[2]);var e=r.c2;r=this._calculateCurveControlPoints(a[1],a[2],a[3]);var n=r.c1,i=new L(a[1],e,n,a[2]),s=this._calculateCurveWidths(i);return a.shift(),{curve:i,widths:s}}return{}};f.prototype._calculateCurveControlPoints=function(t,a,r){var e=t.x-a.x,n=t.y-a.y,i=a.x-r.x,s=a.y-r.y,o={x:(t.x+a.x)/2,y:(t.y+a.y)/2},u={x:(a.x+r.x)/2,y:(a.y+r.y)/2},l=Math.sqrt(e*e+n*n),h=Math.sqrt(i*i+s*s),p=o.x-u.x,c=o.y-u.y,v=h/(l+h),g={x:u.x+p*v,y:u.y+c*v},y=a.x-g.x,_=a.y-g.y;return{c1:new C(o.x+y,o.y+_),c2:new C(u.x+y,u.y+_)}};f.prototype._calculateCurveWidths=function(t){var a=t.startPoint,r=t.endPoint,e={start:null,end:null},n=this.velocityFilterWeight*r.velocityFrom(a)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(n);return e.start=this._lastWidth,e.end=i,this._lastVelocity=n,this._lastWidth=i,e};f.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)};f.prototype._drawPoint=function(t,a,r){var e=this._ctx;e.moveTo(t,a),e.arc(t,a,r,0,2*Math.PI,!1),this._isEmpty=!1};f.prototype._drawCurve=function(t,a,r){var e=this._ctx,n=r-a,i=Math.floor(t.length());e.beginPath();for(var s=0;s<i;s+=1){var o=s/i,u=o*o,l=u*o,h=1-o,p=h*h,c=p*h,v=c*t.startPoint.x;v+=3*p*o*t.control1.x,v+=3*h*u*t.control2.x,v+=l*t.endPoint.x;var g=c*t.startPoint.y;g+=3*p*o*t.control1.y,g+=3*h*u*t.control2.y,g+=l*t.endPoint.y;var y=a+l*n;this._drawPoint(v,g,y)}e.closePath(),e.fill()};f.prototype._drawDot=function(t){var a=this._ctx,r=typeof this.dotSize=="function"?this.dotSize():this.dotSize;a.beginPath(),this._drawPoint(t.x,t.y,r),a.closePath(),a.fill()};f.prototype._fromData=function(t,a,r){for(var e=0;e<t.length;e+=1){var n=t[e];if(n.length>1)for(var i=0;i<n.length;i+=1){var s=n[i],o=new C(s.x,s.y,s.time),u=s.color;if(i===0)this.penColor=u,this._reset(),this._addPoint(o);else if(i!==n.length-1){var l=this._addPoint(o),h=l.curve,p=l.widths;h&&p&&a(h,p,u)}}else{this._reset();var c=n[0];r(c)}}};f.prototype._toSVG=function(){var t=this,a=this._data,r=this._canvas,e=Math.max(window.devicePixelRatio||1,1),n=0,i=0,s=r.width/e,o=r.height/e,u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttributeNS(null,"width",r.width),u.setAttributeNS(null,"height",r.height),this._fromData(a,function(x,P,S){var m=document.createElement("path");if(!isNaN(x.control1.x)&&!isNaN(x.control1.y)&&!isNaN(x.control2.x)&&!isNaN(x.control2.y)){var b="M "+x.startPoint.x.toFixed(3)+","+x.startPoint.y.toFixed(3)+" "+("C "+x.control1.x.toFixed(3)+","+x.control1.y.toFixed(3)+" ")+(x.control2.x.toFixed(3)+","+x.control2.y.toFixed(3)+" ")+(x.endPoint.x.toFixed(3)+","+x.endPoint.y.toFixed(3));m.setAttribute("d",b),m.setAttribute("stroke-width",(P.end*2.25).toFixed(3)),m.setAttribute("stroke",S),m.setAttribute("fill","none"),m.setAttribute("stroke-linecap","round"),u.appendChild(m)}},function(x){var P=document.createElement("circle"),S=typeof t.dotSize=="function"?t.dotSize():t.dotSize;P.setAttribute("r",S),P.setAttribute("cx",x.x),P.setAttribute("cy",x.y),P.setAttribute("fill",x.color),u.appendChild(P)});var l="data:image/svg+xml;base64,",h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+n+" "+i+" "+s+" "+o+'"')+(' width="'+s+'"')+(' height="'+o+'"')+">",p=u.innerHTML;if(p===void 0){var c=document.createElement("dummy"),v=u.childNodes;c.innerHTML="";for(var g=0;g<v.length;g+=1)c.appendChild(v[g].cloneNode(!0));p=c.innerHTML}var y="</svg>",_=h+p+y;return l+btoa(_)};f.prototype.fromData=function(t){var a=this;this.clear(),this._fromData(t,function(r,e){return a._drawCurve(r,e.start,e.end)},function(r){return a._drawDot(r)}),this._data=t};f.prototype.toData=function(){return this._data};var M={exports:{}},Ce=M.exports,U;function Te(){return U||(U=1,function(t,a){(function(r,e){t.exports=e()})(Ce,function(){return function(r){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return r[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=r,e.c=n,e.p="",e(0)}([function(r,e){function n(l){var h=l.getContext("2d"),p=l.width,c=l.height,v=h.getImageData(0,0,p,c).data,g=o(!0,p,c,v),y=o(!1,p,c,v),_=u(!0,p,c,v),x=u(!1,p,c,v),P=x-_+1,S=y-g+1,m=h.getImageData(_,g,P,S);return l.width=P,l.height=S,h.clearRect(0,0,P,S),h.putImageData(m,0,0),l}function i(l,h,p,c){return{red:c[4*(p*h+l)],green:c[4*(p*h+l)+1],blue:c[4*(p*h+l)+2],alpha:c[4*(p*h+l)+3]}}function s(l,h,p,c){return i(l,h,p,c).alpha}function o(l,h,p,c){for(var v=l?1:-1,g=l?0:p-1,y=g;l?y<p:y>-1;y+=v)for(var _=0;_<h;_++)if(s(_,y,h,c))return y;return null}function u(l,h,p,c){for(var v=l?1:-1,g=l?0:h-1,y=g;l?y<h:y>-1;y+=v)for(var _=0;_<p;_++)if(s(y,_,h,c))return y;return null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}])})}(M)),M.exports}var qe=Te();const Fe=V(qe);var ke=["canvasProps","clearOnResize"],j=function(t){X(r,t);var a=Y(r);function r(){var e;Z(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=a.call.apply(a,[this].concat(i)),e.staticThis=e.constructor,e._sigPad=null,e._canvas=null,e.setRef=function(o){e._canvas=o,e._canvas===null&&(e._sigPad=null)},e._excludeOurProps=function(){var o=e.props;o.canvasProps,o.clearOnResize;var u=ee(o,ke);return u},e.componentDidMount=function(){var o=e.getCanvas();e._sigPad=new f(o,e._excludeOurProps()),e._resizeCanvas(),e.on()},e.componentWillUnmount=function(){e.off()},e.componentDidUpdate=function(){Object.assign(e._sigPad,e._excludeOurProps())},e.getCanvas=function(){if(e._canvas===null)throw e.staticThis.refNullError;return e._canvas},e.getTrimmedCanvas=function(){var o=e.getCanvas(),u=document.createElement("canvas");return u.width=o.width,u.height=o.height,u.getContext("2d").drawImage(o,0,0),Fe(u)},e.getSignaturePad=function(){if(e._sigPad===null)throw e.staticThis.refNullError;return e._sigPad},e._checkClearOnResize=function(){e.props.clearOnResize&&e._resizeCanvas()},e._resizeCanvas=function(){var o,u,l=(o=e.props.canvasProps)!==null&&o!==void 0?o:{},h=l.width,p=l.height;if(!(typeof h<"u"&&typeof p<"u")){var c=e.getCanvas(),v=Math.max((u=window.devicePixelRatio)!==null&&u!==void 0?u:1,1);typeof h>"u"&&(c.width=c.offsetWidth*v),typeof p>"u"&&(c.height=c.offsetHeight*v),c.getContext("2d").scale(v,v),e.clear()}},e.render=function(){var o=e.props.canvasProps;return Q.createElement("canvas",te({ref:e.setRef},o))},e.on=function(){return window.addEventListener("resize",e._checkClearOnResize),e.getSignaturePad().on()},e.off=function(){return window.removeEventListener("resize",e._checkClearOnResize),e.getSignaturePad().off()},e.clear=function(){return e.getSignaturePad().clear()},e.isEmpty=function(){return e.getSignaturePad().isEmpty()},e.fromDataURL=function(o,u){return e.getSignaturePad().fromDataURL(o,u)},e.toDataURL=function(o,u){return e.getSignaturePad().toDataURL(o,u)},e.fromData=function(o){return e.getSignaturePad().fromData(o)},e.toData=function(){return e.getSignaturePad().toData()},e}return J(r)}(G.Component);j.propTypes={velocityFilterWeight:w.number,minWidth:w.number,maxWidth:w.number,minDistance:w.number,dotSize:w.oneOfType([w.number,w.func]),penColor:w.string,throttle:w.number,onEnd:w.func,onBegin:w.func,canvasProps:w.object,clearOnResize:w.bool};j.defaultProps={clearOnResize:!0};j.refNullError=new Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");const Me=(t,a)=>{const r=t.split(","),e=r[0].match(/:(.*?);/)[1],n=atob(r[1]);let i=n.length;const s=new Uint8Array(i);for(;i--;)s[i]=n.charCodeAt(i);return new File([s],a,{type:e})},je=()=>{const t=G.useRef(null),a=F(n=>n.editFirma);return{sigCanvas:t,clearSignature:()=>{t.current.clear(),a(null)},saveSignature:()=>{const n=t.current.toDataURL("image/png"),i=Me(n,"firma.png");a(i),E.success("Firma guardada")}}},Re=({view:t,formData:a})=>{const{sigCanvas:r,clearSignature:e,saveSignature:n}=je();return d.jsx("div",{className:"sm:col-span-6 md:col-span-1",children:t||a.devuelto==="SI"?d.jsxs(d.Fragment,{children:[d.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Imagen de la firma:"}),d.jsx("img",{className:"border-5 border-[#27548A] border-double w-full h-60",src:a==null?void 0:a.firma_guardia_url,alt:`Firma del guardia ${a==null?void 0:a.guardia}`})]}):d.jsxs(d.Fragment,{children:[(a==null?void 0:a.firma_guardia_url)&&d.jsxs("a",{href:a.firma_guardia_url,target:"_blank",className:"text-md w-[max-content] ml-auto font-semibold text-gray-800 mb-2 flex items-center justify-end hover:text-gray-400 transition-all",children:["Ver firma actual",d.jsx(ge,{className:"h-4"})]}),d.jsx(j,{ref:r,canvasProps:{className:"border-5 border-[#27548A] border-double w-full h-60"}}),d.jsxs("div",{className:"flex mt-4 flex-col items-center gap-3 justify-center sm:flex-row sm:justify-around",children:[d.jsxs("button",{onClick:e,type:"button",className:"py-2 px-4 bg-red-500 rounded-sm text-white flex items-center gap-2 cursor-pointer hover:bg-red-700 transition-all",children:[d.jsx(xe,{})," Limpiar firma"]}),d.jsxs("button",{onClick:n,type:"button",className:"py-2 px-4 bg-[#1F7D53] rounded-sm text-white flex items-center gap-2 cursor-pointer hover:bg-[#255F38] transition-all",children:[d.jsx(me,{})," Guardar firma"]})]})]})})},Ne=({name:t,value:a,formData:r,handleCheckboxChange:e,view:n,text:i})=>d.jsx("div",{children:d.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",name:t,value:a,checked:r||!1,onChange:e,className:"sr-only peer",disabled:n}),d.jsx("div",{className:"relative w-9 h-5 bg-gray-500 cursor-pointer peer-disabled:bg-gray-300 peer-disabled:cursor-auto peer-focus:outline-0 outline-0 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"}),d.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900",children:i})]})}),Oe=({view:t,edit:a,formData:r,handleInputChange:e,articulosDisponibles:n,handleCheckboxChange:i})=>{const{articulos:s,loadArti:o,errorArti:u,loadOptionsGuardia:l,loadOptionsVehiculo:h}=H(),p=c=>{const v=`articulo-${c.nombre}-${c.id}`,g=`serie-select-${c.id}`,y=n[v]||[],_=r[v]||!1;return d.jsxs("div",{className:"w-full sm:w-[90%] mx-auto",children:[d.jsx(Ne,{name:v,value:`${c.nombre}-${c.id}`,formData:_,handleCheckboxChange:i,view:r.devuelto==="SI"?!0:t,text:c.nombre}),_&&d.jsx("div",{className:"my-1",children:d.jsx(T,{type:"select",label:"Selecciona número de serie",name:`seleccionado-numero_serie-${c.id}`,required:!0,value:r[`seleccionado-numero_serie-${c.id}`]||"",onChange:e,disabled:r.devuelto==="SI"?!0:t,opcSelect:[{label:"Selecciona una opción",value:""},...y.map(x=>({label:x.numero_serie,value:x.numero_serie}))]},g)})]},c.id)};return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-1 md:grid-cols-1 mb-7",children:[a&&d.jsxs(d.Fragment,{children:[d.jsx(k,{text:"Devolución de equipo"}),d.jsx(T,{type:"select",label:"¿Equipo devuelto? *",name:"devuelto",required:!0,value:r.devuelto||"",onChange:e,disabled:r.devuelto==="SI"?!0:t,opcSelect:[{label:"Selecciona una opción",value:""},{label:"SI",value:"SI"},{label:"NO",value:"NO"}]})]}),r.devuelto==="SI"&&d.jsx(T,{type:"date",label:"Fecha de equipo devuelto *",name:"fecha_devuelto",required:!0,value:r.fecha_devuelto||"",onChange:e,disabled:t}),d.jsx(k,{text:"Información de equipo a prestar"}),_e.generalFields.map(({type:c,label:v,name:g,required:y,opcSelect:_})=>d.jsx(T,{type:c,label:v,name:g,required:y,value:r[g]||"",opcSelect:_,onChange:e,loadOptions:l,disabled:r.devuelto==="SI"?!0:t},g)),d.jsx(k,{text:"Asigna el equipo a prestar"}),d.jsx(T,{type:"async",label:"Selecciona el vehiculo *",name:"vehiculo_id",required:!0,value:r.vehiculo_id||"",onChange:e,loadOptions:h,disabled:r.devuelto==="SI"?!0:t}),!o&&!u&&s.map(p),d.jsx(T,{type:"textarea",label:"Otro(s) equipo(s) no listado(s) (no es obligatorio rellenar)",name:"otro",required:!1,value:r.otro||"",onChange:e,disabled:r.devuelto==="SI"?!0:t}),d.jsx(k,{text:"Firma del guardia"}),d.jsx(Re,{view:t,formData:r})]}),d.jsx("hr",{className:"text-gray-300"}),t?d.jsx(re,{}):d.jsx(ae,{})]})},De=[{key:"guardia",name:"Guardia"},{key:"vehiculo",name:"Vehículo"},{key:"equipo",name:"Equipo asignado"},{key:"fecha_entrega_format",name:"Fecha entrega"},{key:"fecha_devuelto_format",name:"Fecha devuelto"}];function He(){const{modalType:t,currentItem:a,view:r,edit:e,formData:n,handleInputChange:i,articulosDisponibles:s,handleCheckboxChange:o}=de(),{data:u,isLoading:l,isError:h,error:p,handleSubmit:c,handleDelete:v}=H();return h?d.jsx("div",{children:p.message}):d.jsxs("div",{className:"md:p-4 bg-gray-100",children:[d.jsx(he,{columns:De,data:u||[],title:"Asignación de equipo al guardia",loading:l}),(t==="add"||t==="edit"||t==="view")&&d.jsx(ne,{handleSubmit:c,Inputs:d.jsx(Oe,{view:r,edit:e,formData:n,handleInputChange:i,articulosDisponibles:s,handleCheckboxChange:o})}),t==="delete"&&a&&d.jsx(pe,{handleDelete:v})]})}export{He as default};
