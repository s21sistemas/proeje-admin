import{j as e,u as v,t as u}from"./index-CrpPZsvu.js";import{C,B as j,a as F}from"./CancelButtonModal-BoD_aq40.js";import{u as h,a as g,B as S}from"./BaseTable-CsPZTHSS.js";import{M as N}from"./ModalDelete-CfgHdyab.js";import{A as f}from"./AlertaCard-CTxQbRQP.js";import{I as y}from"./InputField-CAlv3cmG.js";import{u as D}from"./useQuery-JHOG_8HK.js";import{u as q,S as m}from"./sweetalert2.esm.all-C9US9OKy.js";import{e as M,f as E,h as I,i as T}from"./useReportes-fRvlvEg1.js";import"./eye-DTpaqRd9.js";import"./circle-alert-DY7SbZfB.js";const x={contactoAdminFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre_contacto_admin"},{required:!0,type:"text",label:"Teléfono *",name:"telefono_contacto_admin"},{required:!0,type:"text",label:"WhatsApp *",name:"whatsapp_contacto_admin"},{required:!0,type:"email",label:"Correo *",name:"correo_contacto_admin"}],contactoOperaFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre_contacto_opera"},{required:!0,type:"text",label:"Teléfono *",name:"telefono_contacto_opera"},{required:!0,type:"text",label:"WhatsApp *",name:"whatsapp_contacto_opera"},{required:!0,type:"email",label:"Correo *",name:"correo_contacto_opera"}],empresaFields:[{required:!0,type:"text",label:"Nombre de la empresa *",name:"nombre_empresa"},{required:!0,type:"text",label:"Calle *",name:"calle"},{required:!0,type:"text",label:"Número *",name:"numero"},{required:!0,type:"text",label:"Colonia *",name:"colonia"},{required:!0,type:"select",label:"Estado *",name:"estado"},{required:!0,type:"select",label:"Municipio *",name:"municipio"},{required:!0,type:"number",label:"Código postal *",name:"cp"},{required:!0,type:"text",label:"País *",name:"pais"},{required:!0,type:"text",label:"Teléfono empresa *",name:"telefono_empresa"},{required:!1,type:"text",label:"Extensión",name:"extension_empresa"},{required:!1,type:"url",label:"Sitio web",name:"pagina_web"},{required:!0,type:"number",label:"Días de crédito *",name:"credito_dias"},{required:!0,type:"select",label:"Método de pago *",name:"metodo_pago",opcSelect:[{label:"Selecciona una opción",value:""},{label:"Transferencia bancaria",value:"Transferencia bancaria"},{label:"Tarjeta de crédito/débito",value:"Tarjeta de crédito/débito"},{label:"Efectivo",value:"Efectivo"},{label:"Cheques",value:"Cheques"}]},{required:!1,type:"url",label:"Plataforma para cargar facturas",name:"plataforma_facturas"},{required:!0,type:"select",label:"¿Se requiere orden de compra? *",name:"orden_compra",opcSelect:[{value:"",label:"Selecciona una opción"},{value:"NO",label:"NO"},{value:"SI",label:"SI"}]}],rfcFields:[{required:!0,type:"text",label:"RFC *",name:"rfc"},{required:!0,type:"text",label:"Razón social *",name:"razon_social"},{required:!0,type:"text",label:"Uso de CFDI *",name:"uso_cfdi"},{required:!0,type:"text",label:"Regimen fiscal *",name:"regimen_fiscal"},{required:!0,type:"file",label:"Situación fiscal *",name:"situacion_fiscal"}]},w=()=>{const{view:r,formData:i,handleInputChange:l,opcionesEstados:c,municipios:d,handleFileChange:p}=h();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos de contacto administrativos"})}),x.contactoAdminFields.map(({type:o,label:s,name:a,required:n})=>e.jsx(y,{type:o,label:s,name:a,required:n,value:i[a]||"",onChange:l,disabled:r,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos de contacto operativo"})}),x.contactoOperaFields.map(({type:o,label:s,name:a,required:n})=>e.jsx(y,{type:o,label:s,name:a,required:n,value:i[a]||"",onChange:l,disabled:r,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos de la empresa"})}),x.empresaFields.map(({type:o,label:s,name:a,required:n,opcSelect:b})=>e.jsx(y,{type:o,label:s,name:a,required:n,value:i[a]||"",onChange:_=>{l(_),a==="estado"&&l({target:{name:"municipio",value:""}})},disabled:a==="municipio"&&d.length===0?!0:r,opcSelect:a==="estado"?c:a==="municipio"?[{value:"",label:"Selecciona un municipio"},...d]:b,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos fiscales"})}),x.rfcFields.map(({type:o,label:s,name:a,required:n})=>e.jsx(y,{type:o,label:s,name:a,required:o==="file"?!1:n,value:i[a]||"",onChange:o==="file"?p:l,disabled:r,classInput:"md:col-span-1",document:i[`${a}_url`]||null},a))]}),e.jsx("hr",{className:"text-gray-300"}),r?e.jsx(C,{}):e.jsx(j,{})]})},R=()=>{const r=g(t=>t.modalType),i=g(t=>t.formData),l=g(t=>t.closeModal),c=v(),{isError:d,data:p,error:o,isLoading:s}=D({queryKey:["clientes"],queryFn:T}),a=q({mutationFn:I,onSuccess:()=>{c.invalidateQueries({queryKey:["clientes"]}),u.success("Registro agregado"),l(),m.close()},onError:t=>{u.error(t.message),m.close()}}),n=q({mutationFn:E,onSuccess:()=>{c.invalidateQueries({queryKey:["clientes"]}),u.success("Registro actualizado"),l(),m.close()},onError:t=>{u.error(t.message),m.close()}}),b=q({mutationFn:M,onSuccess:()=>{c.invalidateQueries({queryKey:["clientes"]}),u.success("Registro eliminado")},onError:t=>{u.error(t.message)}});return{isLoading:s,isError:d,data:p,error:o,createMutation:a,updateMutation:n,deleteMutation:b,handleSubmit:t=>{t.preventDefault(),m.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{m.showLoading()}}),r==="add"?a.mutate(i):r==="edit"&&n.mutate(i)},handleDelete:t=>{b.mutate(t),l()}}},B=[{key:"nombre_empresa",name:"Nombre empresa"},{key:"rfc",name:"RFC"},{key:"razon_social",name:"Razón social"},{key:"nombre_contacto_admin",name:"Nombre admin"},{key:"telefono_contacto_admin",name:"Teléfono admin"}];function H(){const{modalType:r,currentItem:i}=h(),{data:l,isLoading:c,isError:d,error:p,handleSubmit:o,handleDelete:s}=R();return d?e.jsx("div",{children:p.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(S,{columns:B,data:l||[],title:"Clientes",loading:c}),(r==="add"||r==="edit"||r==="view")&&e.jsx(F,{handleSubmit:o,Inputs:e.jsx(w,{})}),r==="delete"&&i&&e.jsx(N,{handleDelete:s})]})}export{H as default};
