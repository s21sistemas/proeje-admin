import{j as e,u as h,t as c}from"./index-CB-Ik059.js";import{I as f,C as j,B as C,a as F}from"./CancelButtonModal-DFIIInB4.js";import{d as q,u as x,z as _,A as D,C as M,D as S,B as N}from"./BaseTable-lMESkOGa.js";import{M as P}from"./ModalDelete-Bkq3cXQz.js";import{A as y}from"./AlertaCard-azZSUJ8e.js";import{u as E}from"./configAxios-zIrC1_jU.js";import{u as b,S as m}from"./sweetalert2.esm.all-nsIXK1sI.js";import"./square-pen-D170uhu7.js";const g={personalFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre_contacto"},{required:!0,type:"text",label:"Teléfono *",name:"telefono_contacto"},{required:!0,type:"text",label:"WhatsApp *",name:"whatsapp_contacto"},{required:!0,type:"email",label:"Correo *",name:"correo"}],empresaFields:[{required:!0,type:"text",label:"Nombre de la empresa *",name:"nombre_empresa"},{required:!0,type:"text",label:"Calle *",name:"calle"},{required:!0,type:"text",label:"Número *",name:"numero"},{required:!0,type:"text",label:"Colonia *",name:"colonia"},{required:!0,type:"select",label:"Estado *",name:"estado"},{required:!0,type:"select",label:"Municipio *",name:"municipio"},{required:!0,type:"number",label:"Código postal *",name:"cp"},{required:!0,type:"text",label:"País *",name:"pais"},{required:!0,type:"text",label:"Teléfono empresa *",name:"telefono_empresa"},{required:!1,type:"text",label:"Extensión",name:"extension_empresa"},{required:!1,type:"url",label:"Sitio web",name:"pagina_web"},{required:!0,type:"number",label:"Días de crédito *",name:"credito_dias"}],rfcFields:[{required:!0,type:"text",label:"RFC *",name:"rfc"},{required:!0,type:"text",label:"Razón social *",name:"razon_social"},{required:!0,type:"text",label:"Uso de CFDI *",name:"uso_cfdi"},{required:!0,type:"text",label:"Regimen fiscal *",name:"regimen_fiscal"}]},w=()=>{const{view:t,formData:n,handleInputChange:s,opcionesEstados:d,municipios:u}=q();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(y,{text:"Datos del contacto"})}),g.personalFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(f,{type:o,label:l,name:a,required:i,value:n[a]||"",onChange:s,disabled:t,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(y,{text:"Datos de la empresa"})}),g.empresaFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(f,{type:o,label:l,name:a,required:i,value:n[a]||"",onChange:p=>{s(p),a==="estado"&&s({target:{name:"municipio",value:""}})},disabled:a==="municipio"&&u.length===0?!0:t,opcSelect:a==="estado"?d:[{value:"",label:"Selecciona un municipio"},...u],classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(y,{text:"Datos fiscales"})}),g.rfcFields.map(({type:o,label:l,name:a,required:i})=>e.jsx(f,{type:o,label:l,name:a,required:o==="file"?!1:i,value:n[a]||"",onChange:s,document:o==="file"?document:!1,disabled:t,classInput:"md:col-span-1"},a))]}),e.jsx("hr",{className:"text-gray-300"}),t?e.jsx(j,{}):e.jsx(C,{})]})},I=()=>{const t=x(r=>r.modalType),n=x(r=>r.formData),s=x(r=>r.closeModal),d=h(),{isError:u,data:o,error:l,isLoading:a}=E({queryKey:["proveedores"],queryFn:S}),i=b({mutationFn:M,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),c.success("Registro agregado"),s(),m.close()},onError:r=>{c.error(r.message),m.close()}}),p=b({mutationFn:D,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),c.success("Registro actualizado"),s(),m.close()},onError:r=>{c.error(r.message),m.close()}}),v=b({mutationFn:_,onSuccess:()=>{d.invalidateQueries({queryKey:["proveedores"]}),c.success("Registro eliminado")},onError:r=>{c.error(r.message)}});return{isLoading:a,isError:u,data:o,error:l,createMutation:i,updateMutation:p,deleteMutation:v,handleSubmit:r=>{r.preventDefault(),m.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{m.showLoading()}}),t==="add"?i.mutate(n):t==="edit"&&p.mutate(n)},handleDelete:r=>{v.mutate(r),s()}}},R=[{key:"nombre_empresa",name:"Nombre de la empresa"},{key:"rfc",name:"RFC"},{key:"razon_social",name:"Razón social"},{key:"nombre_contacto",name:"Nombre contacto"},{key:"telefono_contacto",name:"Teléfono contacto"}];function U(){const{modalType:t,currentItem:n}=q(),{data:s,isLoading:d,isError:u,error:o,handleSubmit:l,handleDelete:a}=I();return u?e.jsx("div",{children:o.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(N,{columns:R,data:s||[],title:"Proveedores",loading:d}),(t==="add"||t==="edit"||t==="view")&&e.jsx(F,{handleSubmit:l,Inputs:e.jsx(w,{})}),t==="delete"&&n&&e.jsx(P,{handleDelete:a})]})}export{U as default};
