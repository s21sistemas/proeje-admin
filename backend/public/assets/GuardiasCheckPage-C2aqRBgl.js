import{r as u,j as e}from"./index-CrpPZsvu.js";import{C as p,B as h,a as f}from"./CancelButtonModal-BoD_aq40.js";import{u as l,B as x}from"./BaseTable-CsPZTHSS.js";import{u as b}from"./useQuery-JHOG_8HK.js";import{o as g,c as y,d as j}from"./firebaseConfig-enmzD80w.js";import{n}from"./useReportes-fRvlvEg1.js";import{A as d}from"./AlertaCard-CTxQbRQP.js";import{I as k}from"./InputField-CAlv3cmG.js";import"./eye-DTpaqRd9.js";import"./circle-alert-DY7SbZfB.js";const c=()=>new Promise(a=>{const t=g(y(j,"guardias_check"),s=>{const i=s.docs.map(r=>({id:r.id,...r.data(),fecha:n(r.data().fecha).format("YYYY-MM-DD HH:mm:ss"),guardia:`${r.data().nombre} (${r.data().numeroEmpleado})`,check:n(r.data().fecha).format("DD/MM/YYYY hh:mm:ss A")}));a({data:i,unsubscribe:t})})}),v=()=>{var t;const a=b({queryKey:["guardias-check"],queryFn:async()=>{const{data:s,unsubscribe:i}=await c();return{data:s,unsubscribe:i}},refetchOnWindowFocus:!1,staleTime:1/0,enabled:!1});return u.useEffect(()=>{let s=null;return c().then(({unsubscribe:i})=>{a.refetch(),s=i}),()=>{s&&s()}},[]),{data:((t=a.data)==null?void 0:t.data)??[],isLoading:a.isLoading,isError:a.isError,error:a.error}},F={generalFields:[{required:!1,type:"text",label:"Orden de servicio",name:"idServicio"},{required:!1,type:"text",label:"Guardia",name:"nombre"},{required:!1,type:"text",label:"No. empleado",name:"numeroEmpleado"},{required:!1,type:"datetime-local",label:"Fecha y hora de check",name:"fecha"},{required:!1,type:"text",label:"Tipo de check",name:"tipo"},{required:!1,type:"textarea",label:"UbicaciÃ³n",name:"ubicacion"},{required:!1,type:"textarea",label:"Comentarios",name:"comentarios"}]},q=()=>{const{view:a,formData:t,handleInputChange:s}=l();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(d,{text:"Imagen del check"})}),e.jsx("div",{className:"sm:col-span-6 md:col-span-2 w-96 mx-auto",children:e.jsx("div",{className:"border-2 rounded-lg p-4 transition-all border-blue-500 flex flex-col items-center justify-center",children:e.jsx("div",{className:"w-full",children:e.jsx("img",{src:t.foto,alt:"Foto del check",className:"max-h-60 mx-auto rounded-md object-contain"})})})}),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(d,{text:"Datos del check"})}),F.generalFields.map(({type:i,label:r,name:o,required:m})=>e.jsx(k,{type:i,label:r,name:o,required:m,value:t[o]||"",onChange:s,disabled:a,classInput:"md:col-span-2"},o))]}),e.jsx("hr",{className:"text-gray-300"}),a?e.jsx(p,{}):e.jsx(h,{})]})},C=[{key:"idServicio",name:"Orden de servicio"},{key:"guardia",name:"Guardia"},{key:"check",name:"Fecha check"},{key:"tipo",name:"Tipo de check"}];function O(){const{modalType:a}=l(),{data:t,isLoading:s,isError:i,error:r}=v();return i?e.jsx("div",{children:r.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(x,{columns:C,data:t||[],title:"Entrada y salida de guardias",loading:s}),a==="view"&&e.jsx(f,{Inputs:e.jsx(q,{})})]})}export{O as default};
