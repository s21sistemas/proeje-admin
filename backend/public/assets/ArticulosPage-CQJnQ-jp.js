import{j as r,u as x,t as l}from"./index-CrpPZsvu.js";import{C as h,B as j,a as q}from"./CancelButtonModal-BoD_aq40.js";import{u as v,a as g,G as S,H as M,I as A,J as F,B as _}from"./BaseTable-CsPZTHSS.js";import{M as I}from"./ModalDelete-CfgHdyab.js";import{I as D}from"./InputField-CAlv3cmG.js";import{u as E}from"./useQuery-JHOG_8HK.js";import{u as y,S as n}from"./sweetalert2.esm.all-C9US9OKy.js";import{g as P}from"./useReportes-fRvlvEg1.js";import"./eye-DTpaqRd9.js";const w={generalFields:[{required:!0,type:"text",label:"Nombre del artículo *",name:"nombre"},{required:!0,type:"number",step:"0.01",label:"Precio de compra *",name:"precio_compra"},{required:!0,type:"number",step:"0.01",label:"Precio de venta *",name:"precio_venta"},{required:!0,type:"number",step:"0.01",label:"Precio de reposición *",name:"precio_reposicion"},{required:!0,type:"select",label:"¿Artículo para asignación de equipo? *",name:"articulo_equipar",opcSelect:[{label:"Selecciona una opción",value:""},{label:"SI",value:"SI"},{label:"NO",value:"NO"}]}]},B=()=>{const{view:a,formData:i,handleInputChange:o}=v();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:w.generalFields.map(({type:s,label:c,name:t,required:u,opcSelect:d,step:m})=>r.jsx(D,{type:s,label:c,name:t,step:m,required:u,value:i[t]||"",opcSelect:d,onChange:o,disabled:a,classInput:"md:col-span-1"},t))}),r.jsx("hr",{className:"text-gray-300"}),a?r.jsx(h,{}):r.jsx(j,{})]})},C=()=>{const a=g(e=>e.modalType),i=g(e=>e.formData),o=g(e=>e.closeModal),s=x(),{isError:c,data:t,error:u,isLoading:d}=E({queryKey:["articulos"],queryFn:F}),m=y({mutationFn:A,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro agregado"),o(),n.close()},onError:e=>{l.error(e.message),n.close()}}),f=y({mutationFn:M,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro actualizado"),o(),n.close()},onError:e=>{l.error(e.message),n.close()}}),b=y({mutationFn:S,onSuccess:()=>{s.invalidateQueries({queryKey:["articulos"]}),l.success("Registro eliminado")},onError:e=>{l.error(e.message)}});return{isLoading:d,isError:c,data:t,error:u,createMutation:m,updateMutation:f,deleteMutation:b,handleSubmit:e=>{e.preventDefault(),n.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{n.showLoading()}}),a==="add"?m.mutate(i):a==="edit"&&f.mutate(i)},handleDelete:e=>{b.mutate(e),o()},loadOptions:async()=>{try{return(await P()).map(p=>({value:p.id,label:`${p.nombre} ${p.apellido_p} ${p.apellido_m}`}))}catch(e){return console.error("Error cargando empleados:",e),[]}}}},O=[{key:"nombre",name:"Artículo"},{key:"precio_compra",name:"Precio de compra"},{key:"precio_venta",name:"Precio de venta"},{key:"precio_reposicion",name:"Precio de reposición"},{key:"articulo_equipar",name:"Artículo para asignar"}];function U(){const{modalType:a,currentItem:i}=v(),{data:o,isLoading:s,isError:c,error:t,handleSubmit:u,handleDelete:d}=C();return c?r.jsx("div",{children:t.message}):r.jsxs("div",{className:"md:p-4 bg-gray-100",children:[r.jsx(_,{columns:O,data:o||[],title:"Articulos",loading:s}),(a==="add"||a==="edit"||a==="view")&&r.jsx(q,{handleSubmit:u,Inputs:r.jsx(B,{})}),a==="delete"&&i&&r.jsx(I,{handleDelete:d})]})}export{U as default};
