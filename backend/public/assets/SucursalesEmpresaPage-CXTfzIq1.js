import{j as e,u as S,t as c}from"./index-CrpPZsvu.js";import{C as j,B as E,a as v}from"./CancelButtonModal-BoD_aq40.js";import{u as q,a as x,r as C,c as M,b as F,g as D,B as _}from"./BaseTable-CsPZTHSS.js";import{M as N}from"./ModalDelete-CfgHdyab.js";import{A as f}from"./AlertaCard-CTxQbRQP.js";import{I as b}from"./InputField-CAlv3cmG.js";import{u as w}from"./useQuery-JHOG_8HK.js";import{u as g,S as m}from"./sweetalert2.esm.all-C9US9OKy.js";import"./useReportes-fRvlvEg1.js";import"./eye-DTpaqRd9.js";import"./circle-alert-DY7SbZfB.js";const h={contactoFields:[{required:!0,type:"text",label:"Nombre *",name:"nombre_contacto"},{required:!0,type:"text",label:"Teléfono *",name:"telefono_contacto"},{required:!0,type:"text",label:"WhatsApp *",name:"whatsapp_contacto"},{required:!0,type:"email",label:"Correo *",name:"correo_contacto"}],sucursalFields:[{required:!0,type:"text",label:"Nombre de la sucursal *",name:"nombre_sucursal"},{required:!0,type:"text",label:"Calle *",name:"calle"},{required:!0,type:"text",label:"Número *",name:"numero"},{required:!0,type:"text",label:"Colonia *",name:"colonia"},{required:!0,type:"select",label:"Estado *",name:"estado"},{required:!0,type:"select",label:"Municipio *",name:"municipio"},{required:!0,type:"number",label:"Código postal *",name:"cp"},{required:!0,type:"text",label:"País *",name:"pais"},{required:!0,type:"text",label:"Teléfono sucursal *",name:"telefono_sucursal"},{required:!1,type:"text",label:"Extensión",name:"extension_sucursal"}]},B=()=>{const{view:t,formData:o,handleInputChange:r,opcionesEstados:l,municipios:i}=q();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6 md:grid-cols-2 mb-7",children:[e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos de contacto"})}),h.contactoFields.map(({type:u,label:n,name:a,required:d})=>e.jsx(b,{type:u,label:n,name:a,required:d,value:o[a]||"",onChange:r,disabled:t,classInput:"md:col-span-1"},a)),e.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e.jsx(f,{text:"Datos de la sucursal"})}),h.sucursalFields.map(({type:u,label:n,name:a,required:d,opcSelect:p})=>e.jsx(b,{type:u,label:n,name:a,required:d,value:o[a]||"",onChange:y=>{r(y),a==="estado"&&r({target:{name:"municipio",value:""}})},disabled:a==="municipio"&&i.length===0?!0:t,opcSelect:a==="estado"?l:a==="municipio"?[{value:"",label:"Selecciona un municipio"},...i]:p,classInput:"md:col-span-1"},a))]}),e.jsx("hr",{className:"text-gray-300"}),t?e.jsx(j,{}):e.jsx(E,{})]})},I=()=>{const t=x(s=>s.modalType),o=x(s=>s.formData),r=x(s=>s.closeModal),l=S(),{isError:i,data:u,error:n,isLoading:a}=w({queryKey:["sucursales-empresa"],queryFn:D}),d=g({mutationFn:M,onSuccess:()=>{l.invalidateQueries({queryKey:["sucursales-empresa"]}),c.success("Registro agregado"),r(),m.close()},onError:s=>{c.error(s.message),m.close()}}),p=g({mutationFn:F,onSuccess:()=>{l.invalidateQueries({queryKey:["sucursales-empresa"]}),c.success("Registro actualizado"),r(),m.close()},onError:s=>{c.error(s.message),m.close()}}),y=g({mutationFn:C,onSuccess:()=>{l.invalidateQueries({queryKey:["sucursales-empresa"]}),c.success("Registro eliminado")},onError:s=>{c.error(s.message)}});return{isLoading:a,isError:i,data:u,error:n,handleSubmit:s=>{s.preventDefault(),m.fire({title:'<h2 style="font-family: "sans-serif";">Guardando registro, por favor espere...</h2>',allowEscapeKey:!1,allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{m.showLoading()}}),t==="add"?d.mutate(o):t==="edit"&&p.mutate(o)},handleDelete:s=>{y.mutate(s),r()}}},T=[{key:"nombre_sucursal",name:"Sucursal"},{key:"direccion",name:"Dirección"},{key:"telefono_sucursal",name:"Teléfono"},{key:"nombre_contacto",name:"Nombre contacto"}];function U(){const{modalType:t,currentItem:o}=q(),{data:r,isLoading:l,isError:i,error:u,handleSubmit:n,handleDelete:a}=I();return i?e.jsx("div",{children:u.message}):e.jsxs("div",{className:"md:p-4 bg-gray-100",children:[e.jsx(_,{columns:T,data:r||[],title:"Sucursales PROEJE",loading:l}),(t==="add"||t==="edit"||t==="view")&&e.jsx(v,{handleSubmit:n,Inputs:e.jsx(B,{})}),t==="delete"&&o&&e.jsx(N,{handleDelete:a})]})}export{U as default};
